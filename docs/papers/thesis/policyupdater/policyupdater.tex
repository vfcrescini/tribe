\documentclass[11pt]{report}
\usepackage{times}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{alltt}

% a variable margin environment
\newenvironment{vvarmargin}[2]
{
  \begin{list}{}
  {
    \setlength{\topsep}{0pt}
    \setlength{\leftmargin}{0pt}
    \setlength{\rightmargin}{0pt}
    \setlength{\listparindent}{\parindent}
    \setlength{\itemindent}{\parindent}
    \setlength{\parsep}{0pt plus 1pt}
    \addtolength{\leftmargin}{#1}\addtolength{\rightmargin}{#2}
  }
  \item
}
{
  \end{list}
}

% definition environment
\newtheorem{vdefinition}{Definition}

% example environment
\newtheorem{vexample}{Example}

% verbatim environment
\newenvironment{vverbatim}
{
  \begin{alltt}
}
{
  \vspace{-\baselineskip}
  \end{alltt}
}

% create a quote environment without a right-hand margin
\newenvironment{vquote}
{
  \begin{list}{}{\leftmargin 1em}\item[]
}
{
  \end{list}
}

\begin{document}
  \onehalfspacing

  \chapter{Temporal Constraints in Authorisation Policies}

    \section{Introduction}

      An obvious limitation of language ${\cal L}$ is its lack of expressive
      power to represent time-dependent authorisations. Consider the following
      authorisation rule:
  
      \begin{vquote}
        $Bob$ holds $read$ access to file $f$ between $9:00$ $AM$ and $5:00$
        $PM$
      \end{vquote}
  
      The authorisation information above can be broken down into two parts: an
      authorisation part, i.e. "Bob holds read access to file $f$", and a
      temporal part, i.e. "between 9:00 AM and 5:00 PM". As language ${\cal L}$
      can already express authorisations, we focus our attention to the
      temporal part. A naive attempt to extend language ${\cal L}$ to express
      time may involve adding two extra parameters to each authorisation atom
      to represent the starting and ending time points of the interval. For
      example, the authorisation rule above can be represented as:
  
      \begin{vquote}
        $holds$($bob$, $read$, $f$, $900$, $1700$)
      \end{vquote}

      The atom above may be interpreted to mean that the authorisation holds
      for all times between 9:00 AM and 5:00 PM, inclusive. In this example,
      the granularity of time, or the smallest unit of time that can be
      expressed, is one minute. Of course, a more general approach is to use
      the domain of positive integers. With this approach, the system can
      handle different granularities of time, where the choice of what time
      unit each discrete value is interpreted as is left to the application.
      For example, if the temporal values are defined to be the number of
      seconds since 12 midnight, 01 Jan 1970 (i.e. the beginning of the UNIX
      epoch), then the atom below states that the authorisation holds at an
      interval starting at 9:00 AM, 18 March 1976 and ending at 5:00 PM, 18
      March 1976:
 
      \begin{vquote}
        $holds$($bob$, $read$, $f$, $195951600$, $195980400$)
      \end{vquote}

      While this approach gives the language enough expressive power to
      represent authorisations bound by literal time values, it is by no means
      expressive enough to model relationships between the time values
      themselves. This deficiency is shown in the example below:
 
      \begin{vquote}
        $Alice$ holds a $write$ access right to file $f_0$ after $Bob$ holds a
        $read$ access right to file $f_1$
      \end{vquote}
 
      Such authorisation rule might arise in a situation where the access right
      $write$ to file $f_0$ can only be granted at some time after the $read$
      access right to file $f_1$ has been granted and revoked. This example
      shows that the specific times at which authorisations hold are not as
      important as the relationship between the times themselves. This
      authorisation rule may be represented as follows:

      \begin{vquote}
        $holds$($alice$, $write$, $f_0$, $i_{1}$)
 
        $holds$($bob$, $read$, $f_0$, $i_{2}$)
 
        $after$($i_0$, $i_1$)
      \end{vquote}
 
      The example above states that $alice$ holds a $write$ access right to
      file $f_0$ at some time interval $i_0$, $bob$ holds a $read$ access right
      to file $f_1$ at some time interval $i_1$, and that the interval $i_0$
      occurs at some time after the interval $i_1$. As mentioned earlier, the
      actual values of the time intervals $i_0$ and $i_1$ is not as important
      as the fact that the interval $i_0$ occurs after interval $i_1$.

      The rest of this chapter discusses how temporal constraints can be
      incorporated into the authorisation language. The next section introduces
      Allen's Temporal Interval Algebra to express relations between time
      values, followed by a section that outlines extensions to this algebra,
      and finally, the last section gives a detailed formalisation of a new
      authorisation language that utilises the interval algebra to support
      temporal constraints.

    \section{Allen's Temporal Interval Algebra}

      Allen's interval algebra is based on the fact that for any two well
      defined time intervals, there exists exacly one interval relation between
      them. The strength of the algebra lies not just on the formalisation of
      these relations, but also on its ability to handle disjunctive interval
      relations between undefined time intervals.

      For example, given an interval ${i_0}$, defined as 24th of September,
      1995 to 25th of September, 1995; and interval ${i_1}$, defined as 25th of
      December 1995 to 1st of January 1996. From the definitions of these
      intervals, it is easy to conclude that interval ${i_0}$ is {\em before}
      interval ${i_1}$, since the finishing end point of interval ${i_0}$
      occurs before the starting end point of interval ${i_1}$.

      The strength of the interval algebra can be illustrated by considering
      intervals without endpoint definitions, but rather as having disjunctive
      relations with other intervals. For example, given three intervals
      ${i_0}$, ${i_1}$ and ${i_2}$ whose bounding endpoints are not known. The
      algebra allows us to conclude that if ${i_0}$ occurs either {\em before}
      or {\em during} ${i_1}$ and ${i_2}$ occurs {\em after} ${i_1}$, then the
      interval ${i_0}$ must occur {\em before} ${i_2}$.

      The rest of the section gives a detailed overview of Allen's interval
      algebra.

      \subsection{Time Points and Time Intervals}

        The preceding introduction hinted the difference between a time point and a
        time interval. This sub section aims to give a more formal distinction between
        the two.

        A point in time represents an event with zero duration, or an event that occurs
        instantaneouly, such as the switching on of a light bulb, or the moment the sun
        has risen in the morning.

        A time interval, on the other hand, is defined to be the time that has elapsed
        between two given time points. For example, the interval one might call lunch
        hour may be defined as the time elapsed between the time points 1 PM and 2 PM.

        Formally, a time interval $i$ is defined by its starting end point ${i^-}$ and
        a finishing end point ${i^+}$, where ${i^-}$ $<$ ${i^+}$. 

        One might argue that time point events such as the switching on of a light bulb
        are not instantaneous, meaning that time, no matter how small the value, has
        elapsed between the instant that electricity flowed through light bulb's
        fillament and the instant the light from the bulb reaches the observer's eyes.
        One can further argue that the "instant" that electricity flowed through the
        bulb's fillament is not instantaneous, once we consider that the speed of light
        and electricity is finite. In other words, any given event can always be
        divided into sub-events. This argument is more evident in the sunrise example.

        To solve this problem, Allen's algebra defines time intervals as the most basic
        entities. This means time points are not used to define time intervals, but
        instead, each interval is defined only in terms of its relationship with other
        intervals.

      \subsection{Time Interval Relations}

        As shown in Figure \ref{fig-rels}, the algebra defines 13 disjoint relations
        that can occur between any two intervals. For clarity, we define each temporal
        interval relation below in terms of the relationships of the end points of
        their intervals:

        \begin{figure}[[tbhp]
          \begin{center}
            \includegraphics{rels}
            \caption{Thirteen Temporal Interval Relations}
            \label{fig-rels}
          \end{center}
        \end{figure}

        \begin{itemize}
          \item
            {\em Before}.
            Interval ${i_0}$ is said to be {\em before} interval ${i_1}$ if and
            only if ${i_0^+}$ $<$ ${i_1^-}$.

          \item
            {\em After}.
            Interval ${i_0}$ is said to be {\em after} interval ${i_1}$ if and
            only if ${i_0^-}$ $>$ ${i_1^+}$. Note that this is an inverse of
            the {\em before} relation.

          \item
            {\em Meets}.
            Interval ${i_0}$ is said to {\em meet} interval ${i_1}$ if and only
            if ${i_0^+}$ $=$ ${i_1^-}$.

          \item
            {\em Met By}.
            Interval ${i_0}$ is said to be {\em met by} interval ${i_1}$ if and
            only if ${i_0^-}$ $=$ ${i_1^+}$. Note that this is an inverse of
            the {\em meets} relation.

          \item
            {\em During}.
            Interval ${i_0}$ is said to be {\em during} interval ${i_1}$ if and
            only if ${i_0^-}$ $>$ ${i_1^-}$ and ${i_0^+}$ $<$ ${i_1^+}$.

          \item
            {\em Contains}.
            Interval ${i_0}$ is said to {\em contain} interval ${i_1}$ if and
            only if ${i_0^-}$ $<$ ${i_1^-}$ and ${i_0^+}$ $>$ ${i_1^+}$. Note
            that this is an inverse of the {\em during} relation.

          \item
            {\em Overlaps}.
            Interval ${i_0}$ is said to {\em overlap} interval ${i_1}$ if and
            only if ${i_0^-}$ $<$ ${i_1^-}$, ${i_0^+}$ $>$ ${i_1^-}$ and
            ${i_0^+}$ $<$ ${i_1^+}$.

          \item
            {\em Overlapped By}.
            Interval ${i_0}$ is said to be {\em overlapped by} interval
            ${i_1}$ if and only if ${i_0^-}$ $>$ ${i_1^-}$, ${i_0^-}$ $<$
            ${i_1^+}$ and ${i_0^+}$ $>$ ${i_1^+}$. Note that this is an
            inverse of the {\em overlaps} relation.

          \item
            {\em Starts}.
            Interval ${i_0}$ is said to {\em start} interval ${i_1}$ if and
            only if ${i_0^-}$ $=$ ${i_1^-}$ and ${i_0^+}$ $<$ ${i_1^+}$.

          \item
            {\em Started By}.
            Interval ${i_0}$ is said to be {\em started by} interval ${i_1}$ if
            and only if ${i_0^-}$ $=$ ${i_1^-}$ and ${i_0^+}$ $>$ ${i_1^+}$.
            Note that this is an inverse of the the {\em starts} relation.

          \item
            {\em Finishes}.
            Interval ${i_0}$ is said to {\em finish} interval ${i_1}$ if and
            only if ${i_0^-}$ $>$ ${i_1^-}$ and ${i_0^+}$ $=$ ${i_1^+}$.

          \item
            {\em Finished By}.
            Interval ${i_0}$ is said to be {\em finished by} interval ${i_1}$
            if and only if ${i_0^-}$ $<$ ${i_1^-}$ and ${i_0^+}$ $=$ ${i_1^+}$.
            Note that this is an inverse of the {\em finishes} relation.

          \item
            {\em Equals}.
            Interval ${i_0}$ {\em equals} interval ${i_1}$ if and only if ${i_0^-}$
            $=$ ${i_1^-}$ and ${i_0^+}$ $=$ ${i_1^+}$.
        \end{itemize}

        For example, given intervals {\em lunch hour} and {\em work hours},
        defined as 1 PM to 2 PM and 9 AM to 5 PM, respectively. Since 1 PM
        (1300 hours) is greater than 9 AM (0900 hours) and 2 PM (1400 hours) is
        less than 5 PM (1700 hours), then the interval {\em lunch hour} is
        {\em during} the interval {\em work hours}.

      \subsection{Inferring New Relations}

        As mentioned earlier, the strength of the algebra is its ability to infer new
        relations from existing ones. This is achieved by taking advantage of the
        transitive properties of relations. For example, given that interval ${i_0}$ is
        {\em before} interval ${i_1}$ and interval ${i_1}$ is {\em before} interval
        ${i_2}$. Regardless of what the end points are, interval ${i_0}$ is 
        {\em before} interval ${i_2}$.

        While simple relations like the one shown in the above example may seem
        intuitive, we quickly realise that it may not be so if we consider that
        a relation that exists between any two intervals may be given as a
        disjunctive set of possible relations. For example, the relation
        between interval ${i_0}$ and interval ${i_1}$ may be given as a set
        of possible relations \{{\em before}, {\em after}, {\em during}\}.

        Another issue is propagation. Given that the temporal knowledge base
        is populated by these disjunctive interval relations, adding new
        pieces of information may narrow down the set of possible relations
        between two intervals. This in turn may lead to the trimming down of
        other relations between other interval pairs. In fact, as new and more
        specific information are added into the knowledge base, its effects may
        propagate to other relations.

        \subsubsection{Interval Relation Network}

          The temporal interval relation knowledge base is represented as a network
          whose nodes represent intervals and the arcs between them represent a set
          of possible relations that hold between the two intervals. Note that although
          this representation allows the assignment of a set of relations between any
          two intervals, because the relations are mutually exclusive, we know that
          only one of these relations actually holds. The fact that some interval
          pairs have a set of relations between them only suggests that the information
          given is insufficient to define the exact relation that holds between the
          intervals.

          The interval relation network is maintained in such a way that each node
          is connected to every other node in the network. In cases where no
          information is given to define an arc, we use the default arc which contains
          a set of all 13 relations. As a matter of convention in the notation, we only
          show one arc between two nodes. The reverse arc, composed of the inverses of
          the relations represented by the first arc, is omitted.

          Figure \ref{fig-net-ex-01} gives an example of a network with three nodes:
          $i_0$, $i_1$ and $i_2$ and the following relations:

          \begin{itemize}
            \item Interval ${i_0}$ is {\em before} or {\em during} interval ${i_1}$.
            \item Interval ${i_1}$ {\em overlaps} interval $i_2$.
          \end{itemize}

          In this example, note that because no relation is defined for intervals
          ${i_0}$ and ${i_2}$, the corresponding arc between these nodes in Figure
          \ref{fig-net-ex-01} is labelled {\em All}, meaning the relation set contains
          all 13 possible relations.

          \begin{figure}[tbhp]
            \begin{center}
              \includegraphics{net-01}
              \caption{Network Representation Example}
              \label{fig-net-ex-01}
            \end{center}
          \end{figure}

        \begin{table}[p]
          \begin{vvarmargin}{-4cm}{-4cm}
            \begin{center}
              \tiny
              \begin{tabular}[t]{|r|l|l|l|l|l|l|l|l|l|l|l|l|}
                \hline
                                        & \textbf{Before}         & \textbf{After}          & \textbf{During}         & \textbf{Contains}       & \textbf{Overlaps}       & \textbf{Overlapped By}  & \textbf{Meets}          & \textbf{Met}            & \textbf{Starts}         & \textbf{Started By}     & \textbf{Finishes}       & \textbf{Finished By}    \\
                                        & (BEF)                   & (BEI)                   & (DUR)                   & (DUI)                   & (OVR)                   & (OVI)                   & (MET)                   & (MEI)                   & (STA)                   & (STI)                   & (FIN)                   & (FII)                   \\
                \hline                                                                                                                                                                                                                                                                                                                                          
                \textbf{Before}         & BEF                     & ALL                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     & BEF                     \\
                (BEF)                   &                         &                         & OVR                     &                         &                         & OVR                     &                         & OVR                     &                         &                         & OVR                     &                         \\ 
                                        &                         &                         & MET                     &                         &                         & MET                     &                         & MET                     &                         &                         & MET                     &                         \\ 
                                        &                         &                         & DUR                     &                         &                         & DUR                     &                         & DUR                     &                         &                         & DUR                     &                         \\
                                        &                         &                         & STA                     &                         &                         & STA                     &                         & STA                     &                         &                         & STA                     &                         \\
                \hline                                                                                                                                                                                                                                                                                                                                         
                \textbf{After}          & ALL                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     & BEI                     \\
                (BEI)                   &                         &                         & OVI                     &                         & OVI                     &                         & OVI                     &                         & OVI                     &                         &                         &                         \\
                                        &                         &                         & MEI                     &                         & MEI                     &                         & MEI                     &                         & MEI                     &                         &                         &                         \\
                                        &                         &                         & DUR                     &                         & DUR                     &                         & DUR                     &                         & DUR                     &                         &                         &                         \\
                                        &                         &                         & FIN                     &                         & FIN                     &                         & FIN                     &                         & FIN                     &                         &                         &                         \\
                \hline                                                                                                                                                                                                                                                                                                                                         
                \textbf{During}         & BEF                     & BEI                     & DUR                     & ALL                     & BEF                     & BEI                     & BEF                     & BEI                     & DUR                     & BEI                     & DUR                     & BEF                     \\
                (DUR)                   &                         &                         &                         &                         & OVI                     & OVI                     &                         &                         &                         & OVI                     &                         & OVR                     \\
                                        &                         &                         &                         &                         & MET                     & MEI                     &                         &                         &                         & MEI                     &                         & MET                     \\
                                        &                         &                         &                         &                         & DUR                     & DUR                     &                         &                         &                         & DUR                     &                         & DUR                     \\
                                        &                         &                         &                         &                         & STI                     & FIN                     &                         &                         &                         & FIN                     &                         & STA                     \\
                \hline
                \textbf{Contains}       & BEF                     & BEI                     & OVR                     & DUI                     & OVR                     & OVI                     & OVR                     & OVI                     & DUI                     & DUI                     & DUI                     & DUI                     \\
                (DUI)                   & MET                     & DUI                     & DUR                     &                         & DUI                     & DUI                     & DUI                     & DUI                     & FII                     &                         & STI                     &                         \\
                                        & DUI                     & MEI                     & STA                     &                         & FII                     & STI                     & FII                     & STI                     & OVR                     &                         & OVI                     &                         \\
                                        & FII                     & STI                     & FIN                     &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         & STI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         & FII                     &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         & EQL                     &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Overlaps}       & BEF                     & BEI                     & OVR                     & BEF                     & BEF                     & OVR                     & BEF                     & OVI                     & OVR                     & DUI                     & DUR                     & BEF                     \\
                (OVR)                   &                         & OVI                     & DUR                     & OVR                     & OVR                     & OVI                     &                         & DUI                     &                         & FII                     & STA                     & OVR                     \\
                                        &                         & DUI                     & STA                     & MET                     & MET                     & DUR                     &                         & STI                     &                         & OVR                     & OVR                     & MET                     \\
                                        &                         & MEI                     &                         & DUI                     &                         & STA                     &                         &                         &                         &                         &                         &                         \\
                                        &                         & STI                     &                         & FII                     &                         & FIN                     &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         &                         & DUI                     &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         &                         & STI                     &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         &                         & FII                     &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         &                         & EQL                     &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Overlapped By}  & BEF                     & BEI                     & OVI                     & BEI                     & OVR                     & BEI                     & OVR                     & BEI                     & OVI                     & OVI                     & OVI                     & OVI                     \\
                (OVI)                   & OVR                     &                         & DUR                     & OVI                     & OVI                     & OVI                     & DUI                     &                         & DUR                     & BEI                     &                         & DUI                     \\
                                        & MET                     &                         & FIN                     & MEI                     & DUR                     & MEI                     & FII                     &                         & FIN                     & MEI                     &                         & STI                     \\
                                        & DUI                     &                         &                         & DUI                     & STA                     &                         &                         &                         &                         &                         &                         &                         \\
                                        & FII                     &                         &                         & STI                     & FIN                     &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         & STI                     &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         & FII                     &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         &                         & EQL                     &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Meets}          & BEF                     & BEI                     & OVR                     & BEF                     & BEF                     & OVR                     & BEF                     & FIN                     & MET                     & MET                     & DUR                     & BEF                     \\  
                (MET)                   &                         & OVI                     & DUR                     &                         &                         & DUR                     &                         & FII                     &                         &                         & STA                     &                         \\
                                        &                         & MEI                     & STA                     &                         &                         & STA                     &                         & EQL                     &                         &                         & OVR                     &                         \\
                                        &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         & STI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Met By}         & BEF                     & BEI                     & OVI                     & BEI                     & OVI                     & BEI                     & STA                     & BEI                     & DUR                     & BEI                     & MEI                     & MEI                     \\
                (MEI)                   & OVR                     &                         & DUR                     &                         & DUR                     &                         & STI                     &                         & FIN                     &                         &                         &                         \\
                                        & MET                     &                         & FIN                     &                         & FIN                     &                         & EQL                     &                         & OVI                     &                         &                         &                         \\
                                        & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        & FII                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Starts}         & BEF                     & BEI                     & DUR                     & BEF                     & BEF                     & OVI                     & BEF                     & MEI                     & STA                     & STA                     & DUR                     & BEF                     \\
                (STA)                   &                         &                         &                         & OVR                     & OVR                     & DUR                     &                         &                         &                         & STI                     &                         & MET                     \\
                                        &                         &                         &                         & MET                     & MET                     & FIN                     &                         &                         &                         & EQL                     &                         & OVR                     \\
                                        &                         &                         &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         & FII                     &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Started By}     & BEF                     & BEI                     & OVI                     & DUI                     & OVR                     & OVI                     & OVR                     & MEI                     & STA                     & STI                     & OVI                     & DUI                     \\
                (STI)                   & OVR                     &                         & DUR                     &                         & DUI                     &                         & DUI                     &                         & STI                     &                         &                         &                         \\
                                        & MET                     &                         & FIN                     &                         & FII                     &                         & FII       y             &                         & EQL                     &                         &                         &                         \\
                                        & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        & FII                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
                \textbf{Finishes}       & BEF                     & BEI                     & DUR                     & BEI                     & OVR                     & BEI                     & MET                     & BEI                     & DUR                     & BEI                     & FIN                     & FIN                     \\
                (FIN)                   &                         &                         &                         & OVI                     & DUR                     & OVI                     &                         &                         &                         & OVI                     &                         & FII                     \\
                                        &                         &                         &                         & MEI                     & STA                     & MEI                     &                         &                         &                         & MEI                     &                         & EQL                     \\
                                        &                         &                         &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         &                         &                         & STI                     &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline                                                                                                                                                                                                                                                                                                                                          
                \textbf{Finished By}    & BEF                     & BEI                     & OVR                     & DUI                     & OVR                     & OVI                     & MET                     & STI                     & OVR                     & DUI                     & FIN                     & FII                     \\
                (FII)                   &                         & OVI                     & DUR                     &                         &                         & DUI                     &                         & OVI                     &                         &                         & FII                     &                         \\
                                        &                         & MEI                     & STA                     &                         &                         & STI                     &                         & DUI                     &                         &                         & EQL                     &                         \\
                                        &                         & DUI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                                        &                         & STI                     &                         &                         &                         &                         &                         &                         &                         &                         &                         &                         \\
                \hline
              \end{tabular}
            \end{center}
            \caption[]{Transitivity Table}
            \label{table-trans}
          \end{vvarmargin}
        \end{table}

        \subsubsection{Propagation Algorithm}

          The algorithm works as follows. As a starting point, we assume that the
          network contains complete interval relation information, i.e. at each node,
          there is an arc that connects it to every other node. Where there is no
          defined relationship between two nodes, the default arc is used to connect
          these two nodes. The algorithm is invoked whenever new information is to be
          added into the network. Whenever a new relation is added into the network,
          all consequences of this new relation are also added into the network. These
          consequences are computed through the transitive closure of the network. The
          following example illustrates this procedure.

          Given 3 intervals $i_0$, $i_1$ and $i_2$, and the relation $i_0$ is
          {\em before} $i_1$. Suppose the new relation $i_2$ is {\em during} $i_1$ is
          added into the network. The algorithm then infers that $i_0$ is {\em before}
          $i_2$. This new relation is again added into the network in a similar way,
          possibly inferring other new relations as it is added. This procedure is
          repeated until no new information is yielded.

          Table \ref{table-trans} shows the basic transitivity rules. For any 3
          intervals $i_0$, $i_1$ and $i_2$, the relation(s) between intervals
          $i_0$ and $i_2$ is shown in the intersection of the row that contains the
          the relation between $i_0$ and $i_1$, and the column that contains the
          relation between $i_1$ and $i_2$.

          Before we can define the actual algorithm, we must first define a few
          notational constructs.

          For any single relations $r_0$ and $r_1$, the function $Trans_1$($r_0$, $r_1$)
          returns the relation set $RS$ that corresponds to the intersection of $r_0$
          and $r_1$ in Table \ref{table-trans}.

          Using this function, we can then define the extended function
          $Trans_2$($RS_0$, $RS_1$), which takes a pair of relation sets $RS_0$ and
          $RS_1$ as input, and returns the relation set $RS$ which contains all the
          possible relations inferred from the two given relation sets using the
          $Trans_1$() function.

          \begin{vverbatim}
FUNCTION \(Trans\sb{2}\)(\(RS\sb{0}\), \(RS\sb{1}\))
  \(RS\) = \(\emptyset\)
  FOR each \(r\sb{0}\) \(\in\) \(RS\sb{0}\) DO
    FOR each \(r\sb{1}\) \(\in\) \(RS\sb{1}\) DO
      \(RS\) = \(RS\) \(\cup\) \(Trans\sb{1}\)(\(r\sb{0}\), \(r\sb{1}\))
    ENDDO
  ENDDO
  RETURN \(RS\)
ENDFUNCTION
          \end{vverbatim}

          We now define some network oprerators. The first operator,
          $NET.Get$($I_0$, $I_1$), returns the relation set on the arc between
          interval $I_0$ and interval $I_1$. The function $NET.Replace$($I_0$, $I_1$,
          $RS$) blindly replaces the relation set of the arc between $I_0$ and $I_1$
          with the given relation set $RS$. In addition to these network operators,
          we also define a standard queue structure $Q$ which stores a network arc,
          i.e. a pair of intervals and a relation set that holds between the two
          intervals. Thus, we have three operators for the queue structure:
          $Q.Enqueue$($I_0$, $I_1$, $RS$), which enqueues the given arc; and
          $Q.Dequeue$() which returns and removes the oldest arc stored in the queue
          $Q$; and $Q.IsEmpty$() which returns true if the queue is empty and false
          otherwise.

          With these operators, we can now define the network operator to add new
          relations to the network and propagate its effects.

          \begin{vverbatim}
FUNCTION \(NET.Add\)(\(I\sb{0}\), \(I\sb{1}\), \(RS\))
  \(Q.Enqueue\)(\(I\sb{0}\), \(I\sb{1}\), \(RS\))
  WHILE NOT \(Q.IsEmpty\)() DO
    \(I\sb{0}'\), \(I\sb{1}'\), \(RS'\) = \(Q.Dequeue\)()
    \(NET.Replace\)(\(I\sb{0}'\), \(I\sb{1}'\), \(RS'\)) 
    FOR each interval \(I''\) \(\in\) \(NET\) DO
      IF \(I''\) != \(I\sb{0}'\) AND \(I''\) != \(I\sb{1}'\) THEN
        \(RS''\) =  \(Trans\sb{2}\)(\(NET.Get\)(\(I''\), \(I\sb{0}'\)), \(RS'\)) 
        \(RS'''\) = \(NET.Get\)(\(I''\), \(I\sb{1}'\)) \(\cap\) \(RS''\)
        IF \(RS'''\) \(\subset\) \(NET.Get\)(\(I''\), \(I\sb{1}'\)) THEN
          \(Q.Add\)(\(I''\), \(I\sb{1}'\), \(RS'''\))
        ENDIF 
      ENDIF
    ENDDO
    FOR each interval \(I''\) \(\in\) \(NET\) DO
      IF \(I''\) != \(I\sb{0}'\) AND \(I''\) != \(I\sb{1}'\) THEN
        \(RS''\) =  \(Trans\sb{2}\)(\(RS'\), \(NET.Get\)(\(I\sb{1}'\), \(I''\)))
        \(RS'''\) = \(NET.Get\)(\(I\sb{0}'\), \(I''\)) \(\cap\) \(RS''\)
        IF \(RS'''\) \(\subset\) \(NET.Get\)(\(I''\), \(I\sb{0}'\)) THEN
          \(Q.Add\)(\(I\sb{0}'\), \(I''\), \(RS'''\))
        ENDIF 
      ENDIF
    ENDDO
  ENDDO
ENDFUNCTION
          \end{vverbatim}

          The $NET.Add()$ algorithm works as follows. Every time a new arc
          $i_0$, $i_1$ and $rs$ is added, the algorithm finds the transitive
          relation set $RS$ between each of these intervals and every other
          interval $I$ in the network, i.e. the algorithm finds $RS$ =
          $Trans_2$($NET.Get$($I$, $i_0$), $rs$) for every other interval $I$
          in the network. If this new relation set $RS$ contains more specific
          information than what is already in the network, i.e. $RS$ $\subset$
          $NET.Get$($I$, $i_1$), then this new arc between $I$ and $i_1$ (as
          shown in Figure \ref{fig-net-ex-02}) is again put through the same
          algorithm, as it might yield more relation changes.

          \begin{figure}[[tbhp]
            \begin{center}
              \includegraphics{net-02}
              \caption{A new relation $RS$ from interval $I$ and interval $i_1$}
              \label{fig-net-ex-02}
            \end{center}
          \end{figure}

          Note that as shown in Figure \ref{fig-net-ex-03}, the algorithm also
          attempts to form new transitive relations between the given intervals
          $i_0$ and $i_1$ and all other intervals $I$ in the network such that
          interval $I$ is to the right of the other two intervals.

          \begin{figure}[[tbhp]
            \begin{center}
              \includegraphics{net-03}
              \caption{A new relation $RS$ from interval $i_0$ and interval $I$}
              \label{fig-net-ex-03}
            \end{center}
          \end{figure}

          \begin{vexample}
            Given a network with three intervals $i_0$, $i_1$ and $i_2$ where
            no relation between any of the intervals are known. As no relations
            are given, each arc in the network as shown in Figure
            \ref{fig-net-ex-04} is the default arc.

            \begin{figure}[[tbhp]
              \begin{center}
                \includegraphics{net-04}
                \caption{Network with 3 default arcs}
                \label{fig-net-ex-04}
              \end{center}
            \end{figure}

            Now, suppose the relation between interval $i_0$ and interval $i_1$
            is narrowed down to the relation set \{$before$, $meets$,
            $overlaps$\}, i.e., the operation $NET.Add$($i_0$, $i_1$, \{$BEF$,
            $MET$, $OVR$\}) is executed. This operation will yied the network
            shown in Figure \ref{fig-net-ex-05}. Note that because every arc
            in the network contains all relations, the effects of the
            $NET.ADD$() operation are limited to one arc.

            \begin{figure}[[tbhp]
              \begin{center}
                \includegraphics{net-05}
                \caption{Network after $NET.Add$($i_0$, $i_1$, \{$BEF$, $MET$, $OVR$\})}
                \label{fig-net-ex-05}
              \end{center}
            \end{figure}

            Now, if the relation set \{$starts$, $finishes$\} is added to the
            arc between interval $i_1$ and interval $i_2$, the $NET.Add$($i_1$,
            $i_2$, \{$STA$, $FIN$\}) algorithm will also compute the relation
            set $rs_2$ between interval $i_0$ and interval $i_2$ by using the
            relation set $rs_0$ between intervals $i_0$ and interval $i_1$, and
            relation set $rs_1$ between intervals $i_1$ and interval $i_2$ to
            complete the transitivity. In other words, the algorithm computes
            the following:

            \begin{vquote}
              $rs_2$ = $Trans_2$($rs_0$, $rs_1$)

              $rs_2$ = $Trans_2$(\{$BEF$, $MET$, $OVR$\}, \{$STA$, $FIN$\})
            \end{vquote}

            By referring to the transitivity table in Table \ref{table-trans},
            we note the following:

            \begin{vquote}
              $Trans_1$($BEF$, $STA$) = \{$BEF$\}

              $Trans_1$($BEF$, $FIN$) = \{$BEF$, $OVR$, $MET$, $DUR$, $STA$\}

              $Trans_1$($MET$, $STA$) = \{$MET$\}

              $Trans_1$($MET$, $FIN$) = \{$DUR$, $STA$, $OVR$\}

              $Trans_1$($OVR$, $STA$) = \{$OVR$\}

              $Trans_1$($OVR$, $FIN$) = \{$DUR$, $STA$, $OVR$\}
            \end{vquote}

            Therefore, as $Trans_2$() takes the union of all the relation sets
            returned by $Trans_1$(), we have:

            \begin{vquote}
              $rs_2$ = \{$BEF$, $OVR$, $MET$, $DUR$, $STA$\}
            \end{vquote}

            Finally, because $rs_2$ is a subset of $NET.Get$($i_0$, $i_2$), the
            algorithm replaces the arc between $i_0$ and $i_2$ with $rs_2$, as
            shown in Figure \ref{fig-net-ex-06}.

            \begin{figure}[[tbhp]
              \begin{center}
                \includegraphics{net-06}
                \caption{Network after $NET.Add$($i_1$, $i_2$, \{$STA$, $FIN$\})}
                \label{fig-net-ex-06}
              \end{center}
            \end{figure}
          \end{vexample}

    \section{Extensions to Allen's Interval Algebra}

      In the previous section, we have shown that Allen's Algebra defines temporal
      intervals as the primitive, where each interval is defined not by time points,
      but by their relationships with other intervals. In this section, we will attempt
      to show the extensions to the interval algebra to allow it to express intervals
      in terms of time points.

      \subsection{Time Points Revisited}

        By allowing time point definitions to be expressed in the algebra, we must
        formally define time points.

        Disregarding the relativistic effects of gravitation and velocity, we make the
        assumption that time is linear, absolute and universal. That is, time always
        flows in one direction: from past to future; that the passage of time as seen
        by one system is the same for any other system; and that all systems define
        time against a universal frame of reference. For simplicity, we further assume
        that time is not a continuous line, but is instead made up of discrete time
        points.

        As this definition goes against the more intuitive notion of continuous time
        lines, one might see the problem of events falling through the gaps between
        the discrete time points in the non-continuous time line.

        To go around this problem, we allow the time point granularity to be chosen
        arbitrarilty. Ideally, for a specific application, one would choose a
        granularity that is at least as small as the smallest interval in that
        application. In practice, however, such choices are limited by implementing
        system's clock and other hardware and software latencies.

        In the light bulb and sunrise example in the previous section, if we
        choose a granularity of 1 second, then the switching on of a light bulb is an
        event that occurrs at a specific time point. A granularity of 1 second,
        however, means that a sunrise is not an event but an interval, given the fact
        that in most parts of the world, the sun takes a few minutes to rise above the
        horizon. However, if we choose a granularity of 1 hour (and we do not
        live in the polar regions), a sunrise becomes an event that occurs at a single
        point in our chosen time scale. We can therefore argue that given a specific
        time granularity, some events can be treated as instantaneously occuring at a
        specific time point.

        Regardless of the granularity chosen, the domain of time points is the set of
        positive integers ${\mathbb Z}^{+}$.

      \subsection{Defining Intervals in Terms of Time Points}

        \begin{vdefinition}
          \label{def-interval}
          A {\em well-defined interval} $i$ is an interval whose end points $i^{-}$
          $\in$ ${\mathbb Z}^{+}$ and $i^{+}$ $\in$ ${\mathbb Z}^{+}$ are defined,
          where $i^{-}$ $<$ $i^{+}$. A {\em regular interval} is an interval whose
          end points are not known.
        \end{vdefinition}

        Under this definition, we can conclude that for any two well-defined
        intervals there is exactly one interval relation that holds between
        them. We now define a function that will calculate this relation given
        the end points of two well-defined intervals.

        \begin{vverbatim}
FUNCTION \(Compute\)(\(i\sb{0}\sp{-}\), \(i\sb{0}\sp{+}\), \(i\sb{1}\sp{-}\), \(i\sb{1}\sp{+}\))
  IF \(i\sb{0}\sp{-}\) == \(i\sb{1}\sp{-}\) THEN
    IF \(i\sb{0}\sp{+}\) == \(i\sb{1}\sp{+}\) THEN
      RETURN \{\(equals\}\)
    ELSE IF \(i\sb{0}\sp{+}\) < \(i\sb{1}\sp{+}\) THEN
      RETURN \{\(starts\}\)
    ELSE
      RETURN \{\(started by\}\)
    ENDIF 
  ELSE IF \(i\sb{0}\sp{-}\) < \(i\sb{1}\sp{-}\) THEN
    IF \(i\sb{0}\sp{+}\) == \(i\sb{1}\sp{+}\) THEN
      RETURN \{\(finished by\}\)
    ELSE IF \(i\sb{0}\sp{+}\) < \(i\sb{1}\sp{+}\) THEN
      IF \(i\sb{0}\sp{+}\) == \(i\sb{1}\sp{-}\) THEN
        RETURN \{\(meets\}\)
      ELSE IF \(i\sb{0}\sp{+}\) < \(i\sb{1}\sp{-}\) THEN
        RETURN \{\(before\}\)
      ELSE
        RETURN \{\(overlaps\}\)
      ENDIF
    ELSE
      RETURN \{\(contains\}\)
    ENDIF
  ELSE
    IF \(i\sb{0}\sp{+}\) == \(i\sb{1}\sp{+}\) THEN
      RETURN \{\(finishes\}\)
    ELSE IF \(i\sb{0}\sp{+}\) < \(i\sb{1}\sp{+}\) THEN
      RETURN \{\(during\}\)
    ELSE
      IF \(i\sb{0}\sp{-}\) == \(i\sb{1}\sp{+}\) THEN 
        RETURN \{\(met by\}\)
      ELSE IF \(i\sb{0}\sp{-}\) < \(i\sb{1}\sp{+}\) THEN  
        RETURN \{\(overlapped by\}\)
      ELSE
        RETURN \{\(after\}\)
      ENDIF
    ENDIF
  ENDIF
ENDFUNCTION
        \end{vverbatim}

        By using the above algorithm, we can now define a new network operator
        $NET.Bind$($I$, $I^-$, $I^+$) that assigns the end points $I^-$ and
        $I^+$ to the existing interval $I$ in the network. By allowing such
        end points to be defined for any interval, thereby making them
        well-defined intervals, we are also allowing the possibility of
        introducing new relations with this interval. Furthermore, any new
        relations gathered by comparing the end points of well-defined
        intervals are subject to the same propagation algorithms shown in the
        previous section. The algorithm below shows how the $NET.Bind$()
        operator achieves this.

        \begin{vverbatim}
FUNCTION \(NET.Bind\)(\(I\), \(I\sp{-}\), \(I\sp{+}\))
  FOR each interval \(I'\) \(\in\) \(NET\) DO
    IF \(I'\) != \(I\) THEN
      IF \(I'\) is well-defined THEN
        \(RS\) = \(Compute\)(\(I\sp{-}\), \(I\sp{+}\), \(I'\sp{-}\), \(I'\sp{+}\))
        \(NET.Add\)(\(I\), \(I'\), \(RS\))
      ENDIF
    ENDIF
  ENDDO
ENDFUNCTION
        \end{vverbatim}

    \section{Formalisation}

      In this section, we attempt to formalise a new language, ${\cal L^T}$,
      with the same expressive power as language ${\cal L}$ to represent
      authorisation policies, but with extensions to also express temporal
      constraints.

      \subsection{Syntax and Semantics}

        \subsubsection{Components of Language ${\cal L^T}$}

          \begin{itemize}

            \item
              {\bf Entity Identifiers}

              As with language ${\cal L}$, language ${\cal L^T}$ includes six
              disjoint entity sorts: subject, access rights, objects, subject
              groups, access right groups and object groups. The syntax for
              each entity type is a single lower case alpha character followed
              by zero or more alphanumeric or underscore characters:

              \begin{vverbatim}
[a-z][a-zA-Z0-9\_]
              \end{vverbatim}

            \item
              {\bf Interval Identifiers}

              The main difference between language ${\cal L}$ and language
              ${\cal L^T}$ is that in addition to the six entity sorts, 
              language ${\cal L^T}$ also includes an additional time interval
              sort. As it occupies a different name space from the other sorts,
              interval identifiers share the same syntax:

              \begin{vverbatim}
[a-z][a-zA-Z0-9\_]
              \end{vverbatim}

            \item
              {\bf Interval Atoms and Expressions}

              Noting the fact that the inverse relation between any intervals
              $i_0$ and $i_1$ is equal to the relation between intervals
              $i_1$ and $i_0$, for the sake of brevity, language ${\cal L^T}$
              defines only 7 out of the 13 interval relations in the algebra.
              These relations, together with two interval identifiers make up
              the language's interval atoms:

              \begin{vverbatim}
<rel-id>(<int-id-0>, <int-id-1>)
              \end{vverbatim}

              where $rel$-$id$ indicates the relation between interval
              $int$-$id$-$0$ and interval $int$-$id$-$1$, and is one of the
              following: $equals$, $before$, $during$, $overlaps$, $meets$,
              $starts$ or $finishes$.

              An interval expression in language ${\cal L^T}$ is a group
              of interval atoms separated by the comma "," character. As the
              interval algebra allows disjunctions, the meaning of the comma
              within an interval expression may be conjunctive or disjunctive.
              If an interval expression contains two atoms that differ only by
              their relation (meaning the interval pairs are the same), then
              the comma between these atoms indicates a logical "or". Commas
              between other interval atoms indicate a logical "and". For
              example, the following interval expression is interpreted as
              "interval $i_0$ is before or after interval $i_1$ and interval
              $i_2$ is during interval $i_0$":

              \begin{vverbatim}
before(i0, i1), before(i1, i0), during(i2, i0)
              \end{vverbatim}

            \item
              {\bf Authorisation Atoms, Facts and Expressions}

              Authorisation atoms of language ${\cal L^T}$ are similar to the
              to the atoms of language ${\cal L}$, except each atom includes
              an interval parameter that indicates the time at which that atom
              holds. As with language ${\cal L}$, there are three types of
              atoms:

              \begin{itemize}
                \item
                  Holds Atom. The syntax below shows an atom that states that
                  subject $sub$-$id$ holds the access right $acc$-$id$ for
                  object $obj$-$id$ at time interval $int$-$id$.

                  \begin{vverbatim}
holds(<sub-id>, <acc-id>, <obj-id>, <int-id>)
                  \end{vverbatim}

                \item
                  Member Atom. The syntax shown below is that of an atom that
                  states that the single entity $single$-$id$ is a member of
                  the group entity $group$-$id$ for the duration specified by
                  interval $int$-$id$.

                  \begin{vverbatim}
memb(<single-id>, <group-id>, <int-id>)
                  \end{vverbatim}

                \item
                  Subset Atom. Below is the syntax of an atom that states that 
                  the group entity $group$-$id$-$0$ is a subset of the group
                  entity $group$-$id-$-$1$ at time interval $int$-$id$.

                  \begin{vverbatim}
subst(<group-id-0>, <group-id-1>, <int-id>)
                  \end{vverbatim}

              \end{itemize}

              As with language ${\cal L}$, language ${\cal L^T}$ facts state
              that relationship represented by the corresponding atom its
              negation (as indicated by the "!" character prefix) holds.

              An expression is either a fact or a conjunction of facts
              separated by the comma "," character.

          \end{itemize}

        \subsubsection{Identifier Declarations}

          In language ${\cal L^T}$, both entity and interval identifiers must
          be declared before they are used anywhere in the program. The syntax
          for declaring entity identifiers in language ${\cal L^T}$ is the same
          as the syntax in language ${\cal L}$.

          Interval identifiers may be declared with or without end points. Note
          that once intervals are assigned end points, they are bound to those
          end points for the lifetime of the program. End points, if declared
          with an interval identifier, must be a positive integer as indicated
          in the following syntax:

          \begin{vverbatim}
interval <int-id> [\(\backslash\)[ep0, ep1\(\backslash\)]][, ... ];
          \end{vverbatim}

          where $ep_0$ $\in$ ${\mathbb Z}^+$, $ep_1$ $\in$ ${\mathbb Z}^+$ and
          $ep_0$ $<$ $ep_1$.

          For example, the statement below declares interval $i_0$ without end
          points, interval $i_1$ with end points [$1000$, $1200$] and
          interval $i_2$ with endpoints [$1500$, $2300$].

          \begin{vverbatim}
interval i0, i1 [\(1000\), \(1200\)], i2 [\(1500\), \(2300\)];
          \end{vverbatim}

        \subsubsection{Interval Constraint Definitions}

          Interval constrains allow relations between intervals to be defined.
          Such relations will hold for the entire lifetime of the program.
          Syntax is as follows:

            \begin{vverbatim}
relation <int-exp>[, ...];
            \end{vverbatim}

        \subsubsection{Authorisation Constraint Definitions}

        \subsubsection{Policy Update Defintition}

        \subsubsection{Temporal Constraints in Constraint Rule Defintions}

        \subsubsection{Temporal Constraints in Policy Update Rule Definitions}

      \subsection{Computation and Semantic Properties}

  \chapter{Implementation}

    \section{Algorithms}

    \section{Variable Grounding}

\end{document}
