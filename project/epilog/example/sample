/*
 * sample program
 * Vino Crescini  <jcrescin@cit.uws.edu.au
 */

/* identifier declarations */

ident sub alice, bob, charlie, dave, ed, frank;
ident acc read, write, exec;
ident obj file1, file2, file3;
ident sub-grp male, female, scientists, biologists, astrologers;
ident acc-grp owner_access, rx_access;
ident obj-grp accounting_files, engineering_files;

/* initial state */

initially memb(alice, female) && 
          memb(bob, male) && 
          memb(charlie, male);

initially memb(read, owner_access) &&
          memb(write, owner_access) && 
          memb(exec, owner_access) &&
          memb(read, rx_access) &&
          memb(exec, rx_access);

initially memb(file1, accounting_files) &&
          memb(file2, accounting_files) &&
          memb(file3, engineering_files);

initially subst(biologists, scientists) &&
          !subst(astrologers, scientists);

/* transformation declarations */

trans give_read_access(sub_var, obj_var)
  causes holds(sub_var, read, obj_var) 
  if true;

trans give_write_access(sub_var, obj_var)
  causes holds(sub_var, write, obj_var) 
  if true;

trans give_exec_access(sub_var, obj_var)
  causes holds(sub_var, exec, obj_var) 
  if true;

trans become_astrologer(sub_var)
  causes memb(sub_var, astrologers)
  if true;

trans become_biologist(sub_var)
  causes memb(sub_var, biologists)
  if true;

trans dumbify_alice()
  causes memb(alice, astrologers)
  if true;

/* queries */

is holds(alice, read, file1)
  after give_exec_access(alice, file1), 
        give_write_access(alice, file1),
        give_read_access(alice, file2);

is holds(alice, read, file1)
  after give_exec_access(alice, file1), 
        give_write_access(alice, file1),
        give_read_access(alice, file1);

is memb(bob, scientists);

is memb(bob, scientists)
  after become_astrologer(bob);

is memb(bob, scientists)
  after become_astrologer(bob), become_biologist(bob);

is subst(astrologers, scientists);
is subst(biologists, scientists);
is !subst(astrologers, scientists);
is !subst(biologists, scientists);

is memb(alice, biologists) after dumbify_alice();
is memb(alice, astrologers) after dumbify_alice();
